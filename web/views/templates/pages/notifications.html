{{template "layout" .}}
{{define "title"}}Notifications - neverexpire.xyz{{end}}
{{define "content"}}
	<div class="flex flex-col max-w-3xl w-full mx-auto gap-8">
		{{template "h1" withAttributes "Text" "Notifications"}}
		<ul class="flex flex-col">
			<form
				action="/notifications/read"
				method="PUT"
				hx-boost="true"
				hx-push-url="false"
			>
				{{$enabled := false}}
				{{range $notification := .Notifications}}
					{{if not $notification.ReadAt}}
						{{$enabled = true}}
						<input
							type="hidden"
							name="notification_id"
							value="{{$notification.ID}}"
						/>
					{{end}}
				{{end}}
				<button
					type="submit"
					class="font-medium text-primary-600 py-1 disabled:text-base-500"
					{{if not $enabled}}
						disabled
					{{end}}
				>
					Mark all as read
				</button>
			</form>
			{{range $notification := .Notifications}}
				<li class="flex p-2 border-base-200/50 border-b last:border-none">
					<div class="flex flex-wrap">
						{{$classname := ""}}
						{{if not $notification.ReadAt}}
							{{$classname = "relative before:absolute before:top-0 before:left-0 before:content-['â€¢'] before:text-2xl/5 before:text-primary-500"}}
						{{end}}
						<span class="{{cn "pl-5" $classname}}">
							{{$notification.Body}}
						</span>
						<span class="pl-5 w-full text-base-500 text-sm">
							<local-time
								datetime="{{datef $notification.CreatedAt "2006-01-02T15:04:05.000Z"}}"
								short="true"
							>
								{{$notification.CreatedAt}}
							</local-time>
						</span>
					</div>
				</li>
			{{end}}
		</ul>
	</div>
{{end}}
